From 148b63512788103f8f4d5dee8d2cefadb6576c1b Mon Sep 17 00:00:00 2001
From: Dave <zz4077@comcast.net>
Date: Fri, 13 Jun 2014 20:47:13 -0600
Subject: [PATCH 11/26] Removed compiler warnings and small bug fix for
 webhttpd.c

Conflicts:
	configure
---
 CHANGELOG        |   8 +-
 config.h         | 128 ++++++++++
 configure        | 252 +++++++++----------
 ffmpeg.c         |  67 ++---
 jpegutils.c      |  15 +-
 logger.c         |   8 +-
 motion-dist.conf | 732 +++++++++++++++++++++++++++++++++++++++++++++++++++++++
 netcam_ftp.c     |   4 +-
 picture.c        |  17 +-
 stream.c         |  12 +-
 thread1.conf     |  57 +++++
 thread2.conf     |  58 +++++
 thread3.conf     |  60 +++++
 thread4.conf     |  62 +++++
 track.c          |   5 +-
 webhttpd.c       |   8 +
 16 files changed, 1288 insertions(+), 205 deletions(-)
 create mode 100644 config.h
 create mode 100644 motion-dist.conf
 create mode 100644 thread1.conf
 create mode 100644 thread2.conf
 create mode 100644 thread3.conf
 create mode 100644 thread4.conf

diff --git a/CHANGELOG b/CHANGELOG
index df631d3..57671c2 100644
--- a/CHANGELOG
+++ b/CHANGELOG
@@ -49,7 +49,13 @@ Features
      http://www.lavrsen.dk/foswiki/bin/view/Motion/OggTimelapse (Michael Luich)
    * Added support for ffmpeg 0.11 new API.
    * Added RSTP support for netcam ( merge https://github.com/hyperbolic2346/motion )
-
+   * Merge tosiara/rtsp branch (commit 46cfcf31d, 2014/05/21) (Mr-Dave)
+   * Removed compiler warnings:  (Mr-Dave)
+       logger.c,jpegutils.c,netcam_ftp.c,track.c,
+       picture.c,webhttpd.c,stream.c,ffmpeg.c
+   * Bug fix as part of warnings in webhttpd.c fixed(Mr-Dave)
+   * Removed compiler warning regarding ffmpeg being newer than 0.4 version(Mr-Dave)
+   
 Bugfixes
    * Avoid segfault detecting strerror_r() version GNU or SUSv3. (Angel Carpintero)
    * Fix Segfault on reload or quit for vloopback (maybe other v4l1 devices too) (Peter Holik)
diff --git a/config.h b/config.h
new file mode 100644
index 0000000..c479b73
--- /dev/null
+++ b/config.h
@@ -0,0 +1,128 @@
+/* config.h.  Generated from config.h.in by configure.  */
+/* config.h.in.  Generated from configure.in by autoheader.  */
+
+/* Define to 1 if you have the <fcntl.h> header file. */
+#define HAVE_FCNTL_H 1
+
+/* Define to 1 if you have the `get_current_dir_name' function. */
+#define HAVE_GET_CURRENT_DIR_NAME 1
+
+/* Define to 1 if you have the <inttypes.h> header file. */
+#define HAVE_INTTYPES_H 1
+
+/* Define to 1 if you have the <linux/videodev2.h> header file. */
+#define HAVE_LINUX_VIDEODEV2_H 1
+
+/* Define to 1 if you have the <linux/videodev.h> header file. */
+/* #undef HAVE_LINUX_VIDEODEV_H */
+
+/* Define to 1 if you have the <memory.h> header file. */
+#define HAVE_MEMORY_H 1
+
+/* Define to 1 if you have MySQL support */
+/* #undef HAVE_MYSQL */
+
+/* Define to 1 if you have PostgreSQL support */
+/* #undef HAVE_PGSQL */
+
+/* Define to 1 if you have SDL support */
+#define HAVE_SDL 1
+
+/* Define to 1 if you have the <signal.h> header file. */
+#define HAVE_SIGNAL_H 1
+
+/* Define to 1 if you have SQLITE3 support */
+/* #undef HAVE_SQLITE3 */
+
+/* Define to 1 if you have the <stdint.h> header file. */
+#define HAVE_STDINT_H 1
+
+/* Define to 1 if you have the <stdio.h> header file. */
+#define HAVE_STDIO_H 1
+
+/* Define to 1 if you have the <stdlib.h> header file. */
+#define HAVE_STDLIB_H 1
+
+/* Define to 1 if you have the <strings.h> header file. */
+#define HAVE_STRINGS_H 1
+
+/* Define to 1 if you have the <string.h> header file. */
+#define HAVE_STRING_H 1
+
+/* Define to 1 if you have the <sys/ioctl.h> header file. */
+#define HAVE_SYS_IOCTL_H 1
+
+/* Define to 1 if you have the <sys/mman.h> header file. */
+#define HAVE_SYS_MMAN_H 1
+
+/* Define to 1 if you have the <sys/param.h> header file. */
+#define HAVE_SYS_PARAM_H 1
+
+/* Define to 1 if you have the <sys/stat.h> header file. */
+#define HAVE_SYS_STAT_H 1
+
+/* Define to 1 if you have the <sys/types.h> header file. */
+#define HAVE_SYS_TYPES_H 1
+
+/* Define to 1 if you have the <time.h> header file. */
+#define HAVE_TIME_H 1
+
+/* Define to 1 if you have the <unistd.h> header file. */
+#define HAVE_UNISTD_H 1
+
+/* Define to the address where bug reports for this package should be sent. */
+#define PACKAGE_BUGREPORT ""
+
+/* Define to the full name of this package. */
+#define PACKAGE_NAME "motion"
+
+/* Define to the full name and version of this package. */
+#define PACKAGE_STRING "motion trunkREVUNKNOWN"
+
+/* Define to the one symbol short name of this package. */
+#define PACKAGE_TARNAME "motion"
+
+/* Define to the home page for this package. */
+#define PACKAGE_URL ""
+
+/* Define to the version of this package. */
+#define PACKAGE_VERSION "trunkREVUNKNOWN"
+
+/* The size of `int', as computed by sizeof. */
+#define SIZEOF_INT 4
+
+/* The size of `int *', as computed by sizeof. */
+#define SIZEOF_INT_P 4
+
+/* The size of `long int', as computed by sizeof. */
+#define SIZEOF_LONG_INT 4
+
+/* The size of `long long', as computed by sizeof. */
+#define SIZEOF_LONG_LONG 8
+
+/* The size of `short', as computed by sizeof. */
+#define SIZEOF_SHORT 2
+
+/* The size of `void *', as computed by sizeof. */
+#define SIZEOF_VOID_P 4
+
+/* Define to 1 if you have the ANSI C header files. */
+#define STDC_HEADERS 1
+
+/* Define to empty if `const' does not conform to ANSI C. */
+/* #undef const */
+
+/* Define to 1 if you have av_avformat_alloc_context support */
+/* #undef have_av_avformat_alloc_context */
+
+/* Define to 1 if you have av_get_media_type_string support */
+#define have_av_get_media_type_string 1
+
+/* Define to 1 if you have av_register_protocol support */
+/* #undef have_av_register_protocol */
+
+/* Define to 1 if you have av_register_protocol2 support */
+/* #undef have_av_register_protocol2 */
+
+/* Define to 1 if you have avformat_alloc_context support */
+/* #undef have_avformat_alloc_context */
diff --git a/configure b/configure
index 0bdc011..b9b0a24 100755
--- a/configure
+++ b/configure
@@ -1,9 +1,11 @@
 #! /bin/sh
 # Guess values for system-dependent variables and create Makefiles.
-# Generated by GNU Autoconf 2.69 for motion trunkREV561.
+# Generated by GNU Autoconf 2.68 for motion trunkREVUNKNOWN.
 #
 #
-# Copyright (C) 1992-1996, 1998-2012 Free Software Foundation, Inc.
+# Copyright (C) 1992, 1993, 1994, 1995, 1996, 1998, 1999, 2000, 2001,
+# 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010 Free Software
+# Foundation, Inc.
 #
 #
 # This configure script is free software; the Free Software Foundation
@@ -132,31 +134,6 @@ export LANGUAGE
 # CDPATH.
 (unset CDPATH) >/dev/null 2>&1 && unset CDPATH
 
-# Use a proper internal environment variable to ensure we don't fall
-  # into an infinite loop, continuously re-executing ourselves.
-  if test x"${_as_can_reexec}" != xno && test "x$CONFIG_SHELL" != x; then
-    _as_can_reexec=no; export _as_can_reexec;
-    # We cannot yet assume a decent shell, so we have to provide a
-# neutralization value for shells without unset; and this also
-# works around shells that cannot unset nonexistent variables.
-# Preserve -v and -x to the replacement shell.
-BASH_ENV=/dev/null
-ENV=/dev/null
-(unset BASH_ENV) >/dev/null 2>&1 && unset BASH_ENV ENV
-case $- in # ((((
-  *v*x* | *x*v* ) as_opts=-vx ;;
-  *v* ) as_opts=-v ;;
-  *x* ) as_opts=-x ;;
-  * ) as_opts= ;;
-esac
-exec $CONFIG_SHELL $as_opts "$as_myself" ${1+"$@"}
-# Admittedly, this is quite paranoid, since all the known shells bail
-# out after a failed `exec'.
-$as_echo "$0: could not re-execute with $CONFIG_SHELL" >&2
-as_fn_exit 255
-  fi
-  # We don't want this to propagate to other subprocesses.
-          { _as_can_reexec=; unset _as_can_reexec;}
 if test "x$CONFIG_SHELL" = x; then
   as_bourne_compatible="if test -n \"\${ZSH_VERSION+set}\" && (emulate sh) >/dev/null 2>&1; then :
   emulate sh
@@ -190,8 +167,7 @@ if ( set x; as_fn_ret_success y && test x = \"\$1\" ); then :
 else
   exitcode=1; echo positional parameters were not saved.
 fi
-test x\$exitcode = x0 || exit 1
-test -x / || exit 1"
+test x\$exitcode = x0 || exit 1"
   as_suggested="  as_lineno_1=";as_suggested=$as_suggested$LINENO;as_suggested=$as_suggested" as_lineno_1a=\$LINENO
   as_lineno_2=";as_suggested=$as_suggested$LINENO;as_suggested=$as_suggested" as_lineno_2a=\$LINENO
   eval 'test \"x\$as_lineno_1'\$as_run'\" != \"x\$as_lineno_2'\$as_run'\" &&
@@ -236,25 +212,21 @@ IFS=$as_save_IFS
 
 
       if test "x$CONFIG_SHELL" != x; then :
-  export CONFIG_SHELL
-             # We cannot yet assume a decent shell, so we have to provide a
-# neutralization value for shells without unset; and this also
-# works around shells that cannot unset nonexistent variables.
-# Preserve -v and -x to the replacement shell.
-BASH_ENV=/dev/null
-ENV=/dev/null
-(unset BASH_ENV) >/dev/null 2>&1 && unset BASH_ENV ENV
-case $- in # ((((
-  *v*x* | *x*v* ) as_opts=-vx ;;
-  *v* ) as_opts=-v ;;
-  *x* ) as_opts=-x ;;
-  * ) as_opts= ;;
-esac
-exec $CONFIG_SHELL $as_opts "$as_myself" ${1+"$@"}
-# Admittedly, this is quite paranoid, since all the known shells bail
-# out after a failed `exec'.
-$as_echo "$0: could not re-execute with $CONFIG_SHELL" >&2
-exit 255
+  # We cannot yet assume a decent shell, so we have to provide a
+	# neutralization value for shells without unset; and this also
+	# works around shells that cannot unset nonexistent variables.
+	# Preserve -v and -x to the replacement shell.
+	BASH_ENV=/dev/null
+	ENV=/dev/null
+	(unset BASH_ENV) >/dev/null 2>&1 && unset BASH_ENV ENV
+	export CONFIG_SHELL
+	case $- in # ((((
+	  *v*x* | *x*v* ) as_opts=-vx ;;
+	  *v* ) as_opts=-v ;;
+	  *x* ) as_opts=-x ;;
+	  * ) as_opts= ;;
+	esac
+	exec "$CONFIG_SHELL" $as_opts "$as_myself" ${1+"$@"}
 fi
 
     if test x$as_have_required = xno; then :
@@ -356,14 +328,6 @@ $as_echo X"$as_dir" |
 
 
 } # as_fn_mkdir_p
-
-# as_fn_executable_p FILE
-# -----------------------
-# Test if FILE is an executable regular file.
-as_fn_executable_p ()
-{
-  test -f "$1" && test -x "$1"
-} # as_fn_executable_p
 # as_fn_append VAR VALUE
 # ----------------------
 # Append the text in VALUE to the end of the definition contained in VAR. Take
@@ -485,10 +449,6 @@ as_cr_alnum=$as_cr_Letters$as_cr_digits
   chmod +x "$as_me.lineno" ||
     { $as_echo "$as_me: error: cannot create $as_me.lineno; rerun with a POSIX shell" >&2; as_fn_exit 1; }
 
-  # If we had to re-execute with $CONFIG_SHELL, we're ensured to have
-  # already done that, so ensure we don't try to do so again and fall
-  # in an infinite loop.  This has already happened in practice.
-  _as_can_reexec=no; export _as_can_reexec
   # Don't try to exec as it changes $[0], causing all sort of problems
   # (the dirname of $[0] is not the place where we might find the
   # original and so on.  Autoconf is especially sensitive to this).
@@ -523,16 +483,16 @@ if (echo >conf$$.file) 2>/dev/null; then
     # ... but there are two gotchas:
     # 1) On MSYS, both `ln -s file dir' and `ln file dir' fail.
     # 2) DJGPP < 2.04 has no symlinks; `ln -s' creates a wrapper executable.
-    # In both cases, we have to default to `cp -pR'.
+    # In both cases, we have to default to `cp -p'.
     ln -s conf$$.file conf$$.dir 2>/dev/null && test ! -f conf$$.exe ||
-      as_ln_s='cp -pR'
+      as_ln_s='cp -p'
   elif ln conf$$.file conf$$ 2>/dev/null; then
     as_ln_s=ln
   else
-    as_ln_s='cp -pR'
+    as_ln_s='cp -p'
   fi
 else
-  as_ln_s='cp -pR'
+  as_ln_s='cp -p'
 fi
 rm -f conf$$ conf$$.exe conf$$.dir/conf$$.file conf$$.file
 rmdir conf$$.dir 2>/dev/null
@@ -544,8 +504,28 @@ else
   as_mkdir_p=false
 fi
 
-as_test_x='test -x'
-as_executable_p=as_fn_executable_p
+if test -x / >/dev/null 2>&1; then
+  as_test_x='test -x'
+else
+  if ls -dL / >/dev/null 2>&1; then
+    as_ls_L_option=L
+  else
+    as_ls_L_option=
+  fi
+  as_test_x='
+    eval sh -c '\''
+      if test -d "$1"; then
+	test -d "$1/.";
+      else
+	case $1 in #(
+	-*)set "./$1";;
+	esac;
+	case `ls -ld'$as_ls_L_option' "$1" 2>/dev/null` in #((
+	???[sx]*):;;*)false;;esac;fi
+    '\'' sh
+  '
+fi
+as_executable_p=$as_test_x
 
 # Sed expression to map a string onto a valid CPP name.
 as_tr_cpp="eval sed 'y%*$as_cr_letters%P$as_cr_LETTERS%;s%[^_$as_cr_alnum]%_%g'"
@@ -577,8 +557,8 @@ MAKEFLAGS=
 # Identity of this package.
 PACKAGE_NAME='motion'
 PACKAGE_TARNAME='motion'
-PACKAGE_VERSION='trunkREV561'
-PACKAGE_STRING='motion trunkREV561'
+PACKAGE_VERSION='trunkREVUNKNOWN'
+PACKAGE_STRING='motion trunkREVUNKNOWN'
 PACKAGE_BUGREPORT=''
 PACKAGE_URL=''
 
@@ -1160,6 +1140,8 @@ target=$target_alias
 if test "x$host_alias" != x; then
   if test "x$build_alias" = x; then
     cross_compiling=maybe
+    $as_echo "$as_me: WARNING: if you wanted to set the --build type, don't use --host.
+    If a cross compiler is detected then cross compile mode will be used" >&2
   elif test "x$build_alias" != "x$host_alias"; then
     cross_compiling=yes
   fi
@@ -1245,7 +1227,7 @@ if test "$ac_init_help" = "long"; then
   # Omit some internal or obsolete options to make the list less imposing.
   # This message is too long to be a string in the A/UX 3.1 sh.
   cat <<_ACEOF
-\`configure' configures motion trunkREV561 to adapt to many kinds of systems.
+\`configure' configures motion trunkREVUNKNOWN to adapt to many kinds of systems.
 
 Usage: $0 [OPTION]... [VAR=VALUE]...
 
@@ -1306,7 +1288,7 @@ fi
 
 if test -n "$ac_init_help"; then
   case $ac_init_help in
-     short | recursive ) echo "Configuration of motion trunkREV561:";;
+     short | recursive ) echo "Configuration of motion trunkREVUNKNOWN:";;
    esac
   cat <<\_ACEOF
 
@@ -1454,10 +1436,10 @@ fi
 test -n "$ac_init_help" && exit $ac_status
 if $ac_init_version; then
   cat <<\_ACEOF
-motion configure trunkREV561
-generated by GNU Autoconf 2.69
+motion configure trunkREVUNKNOWN
+generated by GNU Autoconf 2.68
 
-Copyright (C) 2012 Free Software Foundation, Inc.
+Copyright (C) 2010 Free Software Foundation, Inc.
 This configure script is free software; the Free Software Foundation
 gives unlimited permission to copy, distribute and modify it.
 _ACEOF
@@ -1533,7 +1515,7 @@ $as_echo "$ac_try_echo"; } >&5
 	 test ! -s conftest.err
        } && test -s conftest$ac_exeext && {
 	 test "$cross_compiling" = yes ||
-	 test -x conftest$ac_exeext
+	 $as_test_x conftest$ac_exeext
        }; then :
   ac_retval=0
 else
@@ -1887,8 +1869,7 @@ int
 main ()
 {
 static int test_array [1 - 2 * !(($2) >= 0)];
-test_array [0] = 0;
-return test_array [0];
+test_array [0] = 0
 
   ;
   return 0;
@@ -1904,8 +1885,7 @@ int
 main ()
 {
 static int test_array [1 - 2 * !(($2) <= $ac_mid)];
-test_array [0] = 0;
-return test_array [0];
+test_array [0] = 0
 
   ;
   return 0;
@@ -1931,8 +1911,7 @@ int
 main ()
 {
 static int test_array [1 - 2 * !(($2) < 0)];
-test_array [0] = 0;
-return test_array [0];
+test_array [0] = 0
 
   ;
   return 0;
@@ -1948,8 +1927,7 @@ int
 main ()
 {
 static int test_array [1 - 2 * !(($2) >= $ac_mid)];
-test_array [0] = 0;
-return test_array [0];
+test_array [0] = 0
 
   ;
   return 0;
@@ -1983,8 +1961,7 @@ int
 main ()
 {
 static int test_array [1 - 2 * !(($2) <= $ac_mid)];
-test_array [0] = 0;
-return test_array [0];
+test_array [0] = 0
 
   ;
   return 0;
@@ -2056,8 +2033,8 @@ cat >config.log <<_ACEOF
 This file contains any messages produced by compilers while
 running configure, to aid debugging if configure makes a mistake.
 
-It was created by motion $as_me trunkREV561, which was
-generated by GNU Autoconf 2.69.  Invocation command line was
+It was created by motion $as_me trunkREVUNKNOWN, which was
+generated by GNU Autoconf 2.68.  Invocation command line was
 
   $ $0 $@
 
@@ -2429,7 +2406,7 @@ do
   IFS=$as_save_IFS
   test -z "$as_dir" && as_dir=.
     for ac_exec_ext in '' $ac_executable_extensions; do
-  if as_fn_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
+  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
     ac_cv_prog_CC="${ac_tool_prefix}gcc"
     $as_echo "$as_me:${as_lineno-$LINENO}: found $as_dir/$ac_word$ac_exec_ext" >&5
     break 2
@@ -2469,7 +2446,7 @@ do
   IFS=$as_save_IFS
   test -z "$as_dir" && as_dir=.
     for ac_exec_ext in '' $ac_executable_extensions; do
-  if as_fn_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
+  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
     ac_cv_prog_ac_ct_CC="gcc"
     $as_echo "$as_me:${as_lineno-$LINENO}: found $as_dir/$ac_word$ac_exec_ext" >&5
     break 2
@@ -2522,7 +2499,7 @@ do
   IFS=$as_save_IFS
   test -z "$as_dir" && as_dir=.
     for ac_exec_ext in '' $ac_executable_extensions; do
-  if as_fn_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
+  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
     ac_cv_prog_CC="${ac_tool_prefix}cc"
     $as_echo "$as_me:${as_lineno-$LINENO}: found $as_dir/$ac_word$ac_exec_ext" >&5
     break 2
@@ -2563,7 +2540,7 @@ do
   IFS=$as_save_IFS
   test -z "$as_dir" && as_dir=.
     for ac_exec_ext in '' $ac_executable_extensions; do
-  if as_fn_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
+  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
     if test "$as_dir/$ac_word$ac_exec_ext" = "/usr/ucb/cc"; then
        ac_prog_rejected=yes
        continue
@@ -2621,7 +2598,7 @@ do
   IFS=$as_save_IFS
   test -z "$as_dir" && as_dir=.
     for ac_exec_ext in '' $ac_executable_extensions; do
-  if as_fn_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
+  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
     ac_cv_prog_CC="$ac_tool_prefix$ac_prog"
     $as_echo "$as_me:${as_lineno-$LINENO}: found $as_dir/$ac_word$ac_exec_ext" >&5
     break 2
@@ -2665,7 +2642,7 @@ do
   IFS=$as_save_IFS
   test -z "$as_dir" && as_dir=.
     for ac_exec_ext in '' $ac_executable_extensions; do
-  if as_fn_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
+  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
     ac_cv_prog_ac_ct_CC="$ac_prog"
     $as_echo "$as_me:${as_lineno-$LINENO}: found $as_dir/$ac_word$ac_exec_ext" >&5
     break 2
@@ -3111,7 +3088,8 @@ cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 #include <stdarg.h>
 #include <stdio.h>
-struct stat;
+#include <sys/types.h>
+#include <sys/stat.h>
 /* Most of the following tests are stolen from RCS 5.7's src/conf.sh.  */
 struct buf { int x; };
 FILE * (*rcsopen) (struct buf *, struct stat *, int);
@@ -3303,7 +3281,7 @@ do
   IFS=$as_save_IFS
   test -z "$as_dir" && as_dir=.
     for ac_exec_ext in '' $ac_executable_extensions; do
-  if as_fn_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
+  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
     ac_cv_prog_CC="${ac_tool_prefix}gcc"
     $as_echo "$as_me:${as_lineno-$LINENO}: found $as_dir/$ac_word$ac_exec_ext" >&5
     break 2
@@ -3343,7 +3321,7 @@ do
   IFS=$as_save_IFS
   test -z "$as_dir" && as_dir=.
     for ac_exec_ext in '' $ac_executable_extensions; do
-  if as_fn_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
+  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
     ac_cv_prog_ac_ct_CC="gcc"
     $as_echo "$as_me:${as_lineno-$LINENO}: found $as_dir/$ac_word$ac_exec_ext" >&5
     break 2
@@ -3396,7 +3374,7 @@ do
   IFS=$as_save_IFS
   test -z "$as_dir" && as_dir=.
     for ac_exec_ext in '' $ac_executable_extensions; do
-  if as_fn_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
+  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
     ac_cv_prog_CC="${ac_tool_prefix}cc"
     $as_echo "$as_me:${as_lineno-$LINENO}: found $as_dir/$ac_word$ac_exec_ext" >&5
     break 2
@@ -3437,7 +3415,7 @@ do
   IFS=$as_save_IFS
   test -z "$as_dir" && as_dir=.
     for ac_exec_ext in '' $ac_executable_extensions; do
-  if as_fn_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
+  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
     if test "$as_dir/$ac_word$ac_exec_ext" = "/usr/ucb/cc"; then
        ac_prog_rejected=yes
        continue
@@ -3495,7 +3473,7 @@ do
   IFS=$as_save_IFS
   test -z "$as_dir" && as_dir=.
     for ac_exec_ext in '' $ac_executable_extensions; do
-  if as_fn_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
+  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
     ac_cv_prog_CC="$ac_tool_prefix$ac_prog"
     $as_echo "$as_me:${as_lineno-$LINENO}: found $as_dir/$ac_word$ac_exec_ext" >&5
     break 2
@@ -3539,7 +3517,7 @@ do
   IFS=$as_save_IFS
   test -z "$as_dir" && as_dir=.
     for ac_exec_ext in '' $ac_executable_extensions; do
-  if as_fn_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
+  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
     ac_cv_prog_ac_ct_CC="$ac_prog"
     $as_echo "$as_me:${as_lineno-$LINENO}: found $as_dir/$ac_word$ac_exec_ext" >&5
     break 2
@@ -3735,7 +3713,8 @@ cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 #include <stdarg.h>
 #include <stdio.h>
-struct stat;
+#include <sys/types.h>
+#include <sys/stat.h>
 /* Most of the following tests are stolen from RCS 5.7's src/conf.sh.  */
 struct buf { int x; };
 FILE * (*rcsopen) (struct buf *, struct stat *, int);
@@ -5129,7 +5108,7 @@ do
     for ac_prog in grep ggrep; do
     for ac_exec_ext in '' $ac_executable_extensions; do
       ac_path_GREP="$as_dir/$ac_prog$ac_exec_ext"
-      as_fn_executable_p "$ac_path_GREP" || continue
+      { test -f "$ac_path_GREP" && $as_test_x "$ac_path_GREP"; } || continue
 # Check for GNU ac_path_GREP and select it if it is found.
   # Check for GNU $ac_path_GREP
 case `"$ac_path_GREP" --version 2>&1` in
@@ -5195,7 +5174,7 @@ do
     for ac_prog in egrep; do
     for ac_exec_ext in '' $ac_executable_extensions; do
       ac_path_EGREP="$as_dir/$ac_prog$ac_exec_ext"
-      as_fn_executable_p "$ac_path_EGREP" || continue
+      { test -f "$ac_path_EGREP" && $as_test_x "$ac_path_EGREP"; } || continue
 # Check for GNU ac_path_EGREP and select it if it is found.
   # Check for GNU $ac_path_EGREP
 case `"$ac_path_EGREP" --version 2>&1` in
@@ -5704,11 +5683,11 @@ else
 int
 main ()
 {
-
+/* FIXME: Include the comments suggested by Paul. */
 #ifndef __cplusplus
-  /* Ultrix mips cc rejects this sort of thing.  */
+  /* Ultrix mips cc rejects this.  */
   typedef int charset[2];
-  const charset cs = { 0, 0 };
+  const charset cs;
   /* SunOS 4.1.1 cc rejects this.  */
   char const *const *pcpcc;
   char **ppc;
@@ -5725,9 +5704,8 @@ main ()
   ++pcpcc;
   ppc = (char**) pcpcc;
   pcpcc = (char const *const *) ppc;
-  { /* SCO 3.2v4 cc rejects this sort of thing.  */
-    char tx;
-    char *t = &tx;
+  { /* SCO 3.2v4 cc rejects this.  */
+    char *t;
     char const *s = 0 ? (char *) 0 : (char const *) 0;
 
     *t++ = 0;
@@ -5743,10 +5721,10 @@ main ()
     iptr p = 0;
     ++p;
   }
-  { /* AIX XL C 1.02.0.0 rejects this sort of thing, saying
+  { /* AIX XL C 1.02.0.0 rejects this saying
        "k.c", line 2.27: 1506-025 (S) Operand must be a modifiable lvalue. */
-    struct s { int j; const int *ap[3]; } bx;
-    struct s *b = &bx; b->j = 5;
+    struct s { int j; const int *ap[3]; };
+    struct s *b; b->j = 5;
   }
   { /* ULTRIX-32 V3.1 (Rev 9) vcc rejects this */
     const int foo = 10;
@@ -6506,16 +6484,16 @@ if (echo >conf$$.file) 2>/dev/null; then
     # ... but there are two gotchas:
     # 1) On MSYS, both `ln -s file dir' and `ln file dir' fail.
     # 2) DJGPP < 2.04 has no symlinks; `ln -s' creates a wrapper executable.
-    # In both cases, we have to default to `cp -pR'.
+    # In both cases, we have to default to `cp -p'.
     ln -s conf$$.file conf$$.dir 2>/dev/null && test ! -f conf$$.exe ||
-      as_ln_s='cp -pR'
+      as_ln_s='cp -p'
   elif ln conf$$.file conf$$ 2>/dev/null; then
     as_ln_s=ln
   else
-    as_ln_s='cp -pR'
+    as_ln_s='cp -p'
   fi
 else
-  as_ln_s='cp -pR'
+  as_ln_s='cp -p'
 fi
 rm -f conf$$ conf$$.exe conf$$.dir/conf$$.file conf$$.file
 rmdir conf$$.dir 2>/dev/null
@@ -6575,16 +6553,28 @@ else
   as_mkdir_p=false
 fi
 
-
-# as_fn_executable_p FILE
-# -----------------------
-# Test if FILE is an executable regular file.
-as_fn_executable_p ()
-{
-  test -f "$1" && test -x "$1"
-} # as_fn_executable_p
-as_test_x='test -x'
-as_executable_p=as_fn_executable_p
+if test -x / >/dev/null 2>&1; then
+  as_test_x='test -x'
+else
+  if ls -dL / >/dev/null 2>&1; then
+    as_ls_L_option=L
+  else
+    as_ls_L_option=
+  fi
+  as_test_x='
+    eval sh -c '\''
+      if test -d "$1"; then
+	test -d "$1/.";
+      else
+	case $1 in #(
+	-*)set "./$1";;
+	esac;
+	case `ls -ld'$as_ls_L_option' "$1" 2>/dev/null` in #((
+	???[sx]*):;;*)false;;esac;fi
+    '\'' sh
+  '
+fi
+as_executable_p=$as_test_x
 
 # Sed expression to map a string onto a valid CPP name.
 as_tr_cpp="eval sed 'y%*$as_cr_letters%P$as_cr_LETTERS%;s%[^_$as_cr_alnum]%_%g'"
@@ -6605,8 +6595,8 @@ cat >>$CONFIG_STATUS <<\_ACEOF || ac_write_fail=1
 # report actual input values of CONFIG_FILES etc. instead of their
 # values after options handling.
 ac_log="
-This file was extended by motion $as_me trunkREV561, which was
-generated by GNU Autoconf 2.69.  Invocation command line was
+This file was extended by motion $as_me trunkREVUNKNOWN, which was
+generated by GNU Autoconf 2.68.  Invocation command line was
 
   CONFIG_FILES    = $CONFIG_FILES
   CONFIG_HEADERS  = $CONFIG_HEADERS
@@ -6667,11 +6657,11 @@ _ACEOF
 cat >>$CONFIG_STATUS <<_ACEOF || ac_write_fail=1
 ac_cs_config="`$as_echo "$ac_configure_args" | sed 's/^ //; s/[\\""\`\$]/\\\\&/g'`"
 ac_cs_version="\\
-motion config.status trunkREV561
-configured by $0, generated by GNU Autoconf 2.69,
+motion config.status trunkREVUNKNOWN
+configured by $0, generated by GNU Autoconf 2.68,
   with options \\"\$ac_cs_config\\"
 
-Copyright (C) 2012 Free Software Foundation, Inc.
+Copyright (C) 2010 Free Software Foundation, Inc.
 This config.status script is free software; the Free Software Foundation
 gives unlimited permission to copy, distribute and modify it."
 
@@ -6759,7 +6749,7 @@ fi
 _ACEOF
 cat >>$CONFIG_STATUS <<_ACEOF || ac_write_fail=1
 if \$ac_cs_recheck; then
-  set X $SHELL '$0' $ac_configure_args \$ac_configure_extra_args --no-create --no-recursion
+  set X '$SHELL' '$0' $ac_configure_args \$ac_configure_extra_args --no-create --no-recursion
   shift
   \$as_echo "running CONFIG_SHELL=$SHELL \$*" >&6
   CONFIG_SHELL='$SHELL'
diff --git a/ffmpeg.c b/ffmpeg.c
index 57eeda4..dbcd7ca 100644
--- a/ffmpeg.c
+++ b/ffmpeg.c
@@ -22,24 +22,11 @@
  * that padded with B frames to obtain the correct framerate.
  */
 #    define FFMPEG_NO_NONSTD_MPEG1
-#    ifdef __GNUC__
-/* #warning is a non-standard gcc extension */
-#        warning **************************************************
-#        warning Your version of FFmpeg is newer than version 0.4.8
-#        warning Newer versions of ffmpeg do not support MPEG1 with
-#        warning non-standard framerate. MPEG1 will be disabled for
-#        warning normal video output. You can still use mpeg4 and
-#        warning and mpeg4ms which are both better in terms of size
-#        warning and quality. MPEG1 is always used for timelapse.
-#        warning Please read the Motion Guide for more information.
-#        warning Note that this is not an error message!
-#        warning **************************************************
-#    endif /* __GNUC__ */
 #endif /* LIBAVCODEC_BUILD > 4680 */
 
-#if defined LIBAVFORMAT_VERSION_MAJOR && defined LIBAVFORMAT_VERSION_MINOR 
+#if defined LIBAVFORMAT_VERSION_MAJOR && defined LIBAVFORMAT_VERSION_MINOR
 #   if LIBAVFORMAT_VERSION_MAJOR < 53 && LIBAVFORMAT_VERSION_MINOR < 45
-#       define GUESS_NO_DEPRECATED 
+#       define GUESS_NO_DEPRECATED
 #   endif
 #endif
 
@@ -63,7 +50,7 @@
 #    define AVSTREAM_CODEC_PTR(avs_ptr) (&avs_ptr->codec)
 #endif /* LIBAVFORMAT_BUILD >= 4629 */
 
-// AV_VERSION_INT(a, b, c) (a<<16 | b<<8 | c) 
+// AV_VERSION_INT(a, b, c) (a<<16 | b<<8 | c)
 // (54*2^16 | 6*2^8 | 100)
 #if LIBAVFORMAT_BUILD >= 3540580
 #define FF_API_NEW_AVIO
@@ -92,9 +79,9 @@ static unsigned char mpeg1_trailer[] = {0x00, 0x00, 0x01, 0xb7};
 // FFMPEG API changed in 0.8
 #if defined FF_API_NEW_AVIO
 
-// TODO 
+// TODO
+
 
-	
 #else
 
 /**
@@ -281,7 +268,7 @@ static int mpeg1_write_trailer(AVFormatContext *s)
 void ffmpeg_init()
 {
     MOTION_LOG(NTC, TYPE_ENCODER, NO_ERRNO, "%s: ffmpeg LIBAVCODEC_BUILD %d"
-               " LIBAVFORMAT_BUILD %d", LIBAVCODEC_BUILD, 
+               " LIBAVFORMAT_BUILD %d", LIBAVCODEC_BUILD,
                LIBAVFORMAT_BUILD);
     av_register_all();
 
@@ -304,7 +291,7 @@ void ffmpeg_init()
 /* Register the append file protocol. */
 #ifdef have_av_register_protocol2
     av_register_protocol2(&mpeg1_file_protocol, sizeof(mpeg1_file_protocol));
-#elif defined have_av_register_protocol        
+#elif defined have_av_register_protocol
     av_register_protocol(&mpeg1_file_protocol);
 #else
 #   warning av_register_protocolXXX missing
@@ -344,10 +331,10 @@ static AVOutputFormat *get_oformat(const char *codec, char *filename)
          * result in a muxed output file, which isn't appropriate here.
          */
 #ifdef GUESS_NO_DEPRECATED
-        of = guess_format("mpeg1video", NULL, NULL);        
+        of = guess_format("mpeg1video", NULL, NULL);
 #else
         of = av_guess_format("mpeg1video", NULL, NULL);
-#endif 
+#endif
         /* But we want the trailer to be correctly written. */
         if (of)
             of->write_trailer = mpeg1_write_trailer;
@@ -362,14 +349,14 @@ static AVOutputFormat *get_oformat(const char *codec, char *filename)
         ext = ".avi";
 #ifdef GUESS_NO_DEPRECATED
         of = guess_format("mpeg1video", NULL, NULL);
-#else        
+#else
         of = av_guess_format("avi", NULL, NULL);
-#endif        
+#endif
     } else if (strcmp(codec, "msmpeg4") == 0) {
         ext = ".avi";
 #ifdef GUESS_NO_DEPRECATED
         of = guess_format("mpeg1video", NULL, NULL);
-#else        
+#else
         of = av_guess_format("avi", NULL, NULL);
 #endif
         /* Manually override the codec id. */
@@ -380,16 +367,16 @@ static AVOutputFormat *get_oformat(const char *codec, char *filename)
         ext = ".swf";
 #ifdef GUESS_NO_DEPRECATED
         of = guess_format("mpeg1video", NULL, NULL);
-#else        
+#else
         of = av_guess_format("swf", NULL, NULL);
-#endif        
+#endif
     } else if (strcmp(codec, "flv") == 0) {
         ext = ".flv";
 #ifdef GUESS_NO_DEPRECATED
         of = guess_format("mpeg1video", NULL, NULL);
-#else        
+#else
         of = av_guess_format("flv", NULL, NULL);
-#endif        
+#endif
         of->video_codec = CODEC_ID_FLV1;
     } else if (strcmp(codec, "ffv1") == 0) {
         ext = ".avi";
@@ -409,7 +396,7 @@ static AVOutputFormat *get_oformat(const char *codec, char *filename)
         ext = ".mov";
 #ifdef GUESS_NO_DEPRECATED
         of = guess_format("mpeg1video", NULL, NULL);
-#else        
+#else
         of = av_guess_format("mov", NULL, NULL);
 #endif
 	    }
@@ -500,7 +487,7 @@ struct ffmpeg *ffmpeg_open(char *ffmpeg_video_codec, char *filename,
     /* Create a new video stream and initialize the codecs. */
     ffmpeg->video_st = NULL;
     if (ffmpeg->oc->oformat->video_codec != CODEC_ID_NONE) {
-#if defined FF_API_NEW_AVIO 
+#if defined FF_API_NEW_AVIO
         ffmpeg->video_st = avformat_new_stream(ffmpeg->oc, NULL /* Codec */);
 #else
         ffmpeg->video_st = av_new_stream(ffmpeg->oc, 0);
@@ -521,11 +508,11 @@ struct ffmpeg *ffmpeg_open(char *ffmpeg_video_codec, char *filename,
 
     ffmpeg->c     = c = AVSTREAM_CODEC_PTR(ffmpeg->video_st);
     c->codec_id   = ffmpeg->oc->oformat->video_codec;
-#if LIBAVCODEC_VERSION_MAJOR < 53    
+#if LIBAVCODEC_VERSION_MAJOR < 53
     c->codec_type = CODEC_TYPE_VIDEO;
 #else
     c->codec_type = AVMEDIA_TYPE_VIDEO;
-#endif    
+#endif
     is_mpeg1      = c->codec_id == CODEC_ID_MPEG1VIDEO;
 
     if (strcmp(ffmpeg_video_codec, "ffv1") == 0)
@@ -865,11 +852,11 @@ int ffmpeg_put_frame(struct ffmpeg *ffmpeg, AVFrame *pic)
     if (ffmpeg->oc->oformat->flags & AVFMT_RAWPICTURE) {
         /* Raw video case. The API will change slightly in the near future for that. */
 #ifdef FFMPEG_AVWRITEFRAME_NEWAPI
-#   if LIBAVCODEC_VERSION_MAJOR < 53        
+#   if LIBAVCODEC_VERSION_MAJOR < 53
         pkt.flags |= PKT_FLAG_KEY;
 #   else
-        pkt.flags |= AV_PKT_FLAG_KEY;  
-#   endif        
+        pkt.flags |= AV_PKT_FLAG_KEY;
+#   endif
         pkt.data = (uint8_t *)pic;
         pkt.size = sizeof(AVPicture);
         ret = av_write_frame(ffmpeg->oc, &pkt);
@@ -883,10 +870,10 @@ int ffmpeg_put_frame(struct ffmpeg *ffmpeg, AVFrame *pic)
         pkt.data = ffmpeg->video_outbuf;
         pkt.size = ffmpeg->video_outbuf_size;
 
-        out_size = avcodec_encode_video2(AVSTREAM_CODEC_PTR(ffmpeg->video_st), 
+        out_size = avcodec_encode_video2(AVSTREAM_CODEC_PTR(ffmpeg->video_st),
                                         &pkt, pic, &got_packet_ptr);
         if (out_size < 0)
-            // Error encondig 
+            // Error encondig
             out_size = 0;
         else
             out_size = pkt.size;
@@ -905,11 +892,11 @@ int ffmpeg_put_frame(struct ffmpeg *ffmpeg, AVFrame *pic)
             pkt.pts = AVSTREAM_CODEC_PTR(ffmpeg->video_st)->coded_frame->pts;
 
             if (AVSTREAM_CODEC_PTR(ffmpeg->video_st)->coded_frame->key_frame)
-#   if LIBAVCODEC_VERSION_MAJOR < 53                
+#   if LIBAVCODEC_VERSION_MAJOR < 53
                 pkt.flags |= PKT_FLAG_KEY;
 #   else
                 pkt.flags |= AV_PKT_FLAG_KEY;
-#   endif                
+#   endif
 
             pkt.data = ffmpeg->video_outbuf;
             pkt.size = out_size;
diff --git a/jpegutils.c b/jpegutils.c
index 84caea4..8998034 100644
--- a/jpegutils.c
+++ b/jpegutils.c
@@ -491,9 +491,9 @@ int decode_jpeg_raw (unsigned char *jpeg_data, int len,
      */
     jpeg_read_header (&dinfo, TRUE);
     dinfo.raw_data_out = TRUE;
-#if JPEG_LIB_VERSION >= 70    
+#if JPEG_LIB_VERSION >= 70
     dinfo.do_fancy_upsampling = FALSE;
-#endif    
+#endif
     dinfo.out_color_space = JCS_YCbCr;
     dinfo.dct_method = JDCT_IFAST;
     guarantee_huff_tables(&dinfo);
@@ -584,9 +584,9 @@ int decode_jpeg_raw (unsigned char *jpeg_data, int len,
         if (field > 0) {
             jpeg_read_header (&dinfo, TRUE);
             dinfo.raw_data_out = TRUE;
-#if JPEG_LIB_VERSION >= 70            
+#if JPEG_LIB_VERSION >= 70
             dinfo.do_fancy_upsampling = FALSE;
-#endif            
+#endif
             dinfo.out_color_space = JCS_YCbCr;
             dinfo.dct_method = JDCT_IFAST;
             jpeg_start_decompress (&dinfo);
@@ -770,7 +770,7 @@ int decode_jpeg_gray_raw(unsigned char *jpeg_data, int len,
                          unsigned int height, unsigned char *raw0,
                          unsigned char *raw1, unsigned char *raw2)
 {
-    int numfields, hsf[3], field, yl, yc, xsl, xsc, xs, xd, hdown;
+    int numfields, field, yl, yc, xsl, xsc, xs, xd, hdown;
     unsigned int x, y, vsf[3];
 
     JSAMPROW row0[16] = { buf0[0], buf0[1], buf0[2], buf0[3],
@@ -805,7 +805,7 @@ int decode_jpeg_gray_raw(unsigned char *jpeg_data, int len,
     dinfo.raw_data_out = TRUE;
 #if JPEG_LIB_VERSION >= 70
     dinfo.do_fancy_upsampling = FALSE;
-#endif    
+#endif
     dinfo.out_color_space = JCS_GRAYSCALE;
     dinfo.dct_method = JDCT_IFAST;
 
@@ -818,7 +818,6 @@ int decode_jpeg_gray_raw(unsigned char *jpeg_data, int len,
     guarantee_huff_tables(&dinfo);
     jpeg_start_decompress (&dinfo);
 
-    hsf[0] = 1; hsf[1] = 1; hsf[2] = 1;
     vsf[0]= 1; vsf[1] = 1; vsf[2] = 1;
 
     /* Height match image height or be exact twice the image height. */
@@ -874,7 +873,7 @@ int decode_jpeg_gray_raw(unsigned char *jpeg_data, int len,
             dinfo.raw_data_out = TRUE;
 #if JPEG_LIB_VERSION >= 70
             dinfo.do_fancy_upsampling = FALSE;
-#endif            
+#endif
             dinfo.out_color_space = JCS_GRAYSCALE;
             dinfo.dct_method = JDCT_IFAST;
             jpeg_start_decompress (&dinfo);
diff --git a/logger.c b/logger.c
index b2e4231..aa47753 100644
--- a/logger.c
+++ b/logger.c
@@ -217,7 +217,7 @@ void motion_log(int level, unsigned int type, int errno_flag, const char *fmt, .
     /* If errno_flag is set, add on the library error message. */
     if (errno_flag) {
       size_t buf_len = strlen(buf);
-      
+
       // just knock off 10 characters if we're that close...
       if (buf_len + 10 > 1024) {
 	buf[1024 - 10] = '\0';
@@ -232,15 +232,9 @@ void motion_log(int level, unsigned int type, int errno_flag, const char *fmt, .
          * my buffer :-(.  I have put in a 'hack' to get around this.
          */
 #if defined(XSI_STRERROR_R)
-#warning "************************************"
-#warning "* Using XSI-COMPLIANT strerror_r() *"
-#warning "************************************"
         /* XSI-compliant strerror_r() */
         strerror_r(errno_save, buf + n, sizeof(buf) - n);    /* 2 for the ': ' */
 #else
-#warning "************************************"
-#warning "* Using GNU-COMPLIANT strerror_r() *"
-#warning "************************************"
         /* GNU-specific strerror_r() */
         strncat(buf, strerror_r(errno_save, msg_buf, sizeof(msg_buf)), 1024 - strlen(buf));
 #endif
diff --git a/motion-dist.conf b/motion-dist.conf
new file mode 100644
index 0000000..30b094f
--- /dev/null
+++ b/motion-dist.conf
@@ -0,0 +1,732 @@
+# Rename this distribution example file to motion.conf
+#
+# This config file was generated by motion trunkREVUNKNOWN
+
+
+############################################################
+# Daemon
+############################################################
+
+# Start in daemon (background) mode and release terminal (default: off)
+daemon on
+
+# File to store the process ID, also called pid file. (default: not defined)
+process_id_file /var/run/motion/motion.pid
+
+############################################################
+# Basic Setup Mode
+############################################################
+
+# Start in Setup-Mode, daemon disabled. (default: off)
+setup_mode off
+
+
+# Use a file to save logs messages, if not defined stderr and syslog is used. (default: not defined)
+;logfile /tmp/motion.log
+
+# Level of log messages [1..9] (EMR, ALR, CRT, ERR, WRN, NTC, INF, DBG, ALL). (default: 6 / NTC)
+log_level 6
+
+# Filter to log messages by type (COR, STR, ENC, NET, DBL, EVT, TRK, VID, ALL). (default: ALL)
+log_type all
+
+###########################################################
+# Capture device options
+############################################################
+
+# Videodevice to be used for capturing  (default /dev/video0)
+# for FreeBSD default is /dev/bktr0
+videodevice /dev/video0
+
+# v4l2_palette allows to choose preferable palette to be use by motion
+# to capture from those supported by your videodevice. (default: 17)
+# E.g. if your videodevice supports both V4L2_PIX_FMT_SBGGR8 and
+# V4L2_PIX_FMT_MJPEG then motion will by default use V4L2_PIX_FMT_MJPEG.
+# Setting v4l2_palette to 2 forces motion to use V4L2_PIX_FMT_SBGGR8
+# instead.
+#
+# Values :
+# V4L2_PIX_FMT_SN9C10X : 0  'S910'
+# V4L2_PIX_FMT_SBGGR16 : 1  'BYR2'
+# V4L2_PIX_FMT_SBGGR8  : 2  'BA81'
+# V4L2_PIX_FMT_SPCA561 : 3  'S561'
+# V4L2_PIX_FMT_SGBRG8  : 4  'GBRG'
+# V4L2_PIX_FMT_SGRBG8  : 5  'GRBG'
+# V4L2_PIX_FMT_PAC207  : 6  'P207'
+# V4L2_PIX_FMT_PJPG    : 7  'PJPG'
+# V4L2_PIX_FMT_MJPEG   : 8  'MJPEG'
+# V4L2_PIX_FMT_JPEG    : 9  'JPEG'
+# V4L2_PIX_FMT_RGB24   : 10 'RGB3'
+# V4L2_PIX_FMT_SPCA501 : 11 'S501'
+# V4L2_PIX_FMT_SPCA505 : 12 'S505'
+# V4L2_PIX_FMT_SPCA508 : 13 'S508'
+# V4L2_PIX_FMT_UYVY    : 14 'UYVY'
+# V4L2_PIX_FMT_YUYV    : 15 'YUYV'
+# V4L2_PIX_FMT_YUV422P : 16 '422P'
+# V4L2_PIX_FMT_YUV420  : 17 'YU12'
+#
+v4l2_palette 17
+
+# Tuner device to be used for capturing using tuner as source (default /dev/tuner0)
+# This is ONLY used for FreeBSD. Leave it commented out for Linux
+; tunerdevice /dev/tuner0
+
+# The video input to be used (default: -1)
+# Should normally be set to 0 or 1 for video/TV cards, and -1 for USB cameras
+input -1
+
+# The video norm to use (only for video capture and TV tuner cards)
+# Values: 0 (PAL), 1 (NTSC), 2 (SECAM), 3 (PAL NC no colour). Default: 0 (PAL)
+norm 0
+
+# The frequency to set the tuner to (kHz) (only for TV tuner cards) (default: 0)
+frequency 0
+
+# Rotate image this number of degrees. The rotation affects all saved images as
+# well as movies. Valid values: 0 (default = no rotation), 90, 180 and 270.
+rotate 0
+
+# Image width (pixels). Valid range: Camera dependent, default: 352
+width 320
+
+# Image height (pixels). Valid range: Camera dependent, default: 288
+height 240
+
+# Maximum number of frames to be captured per second.
+# Valid range: 2-100. Default: 100 (almost no limit).
+framerate 2
+
+# Minimum time in seconds between capturing picture frames from the camera.
+# Default: 0 = disabled - the capture rate is given by the camera framerate.
+# This option is used when you want to capture images at a rate lower than 2 per second.
+minimum_frame_time 0
+
+# URL to use if you are using a network camera, size will be autodetected (incl http:// ftp:// mjpg:// rstp:// or file:///)
+# Must be a URL that returns single jpeg pictures or a raw mjpeg stream. Default: Not defined
+; netcam_url value
+
+# Username and password for network camera (only if required). Default: not defined
+# Syntax is user:password
+; netcam_userpass value
+
+# The setting for keep-alive of network socket, should improve performance on compatible net cameras.
+# off:   The historical implementation using HTTP/1.0, closing the socket after each http request.
+# force: Use HTTP/1.0 requests with keep alive header to reuse the same connection.
+# on:    Use HTTP/1.1 requests that support keep alive as default.
+# Default: off
+netcam_keepalive off
+
+# URL to use for a netcam proxy server, if required, e.g. "http://myproxy".
+# If a port number other than 80 is needed, use "http://myproxy:1234".
+# Default: not defined
+; netcam_proxy value
+
+# Set less strict jpeg checks for network cameras with a poor/buggy firmware.
+# Default: off
+netcam_tolerant_check off
+
+# Let motion regulate the brightness of a video device (default: off).
+# The auto_brightness feature uses the brightness option as its target value.
+# If brightness is zero auto_brightness will adjust to average brightness value 128.
+# Only recommended for cameras without auto brightness
+auto_brightness off
+
+# Set the initial brightness of a video device.
+# If auto_brightness is enabled, this value defines the average brightness level
+# which Motion will try and adjust to.
+# Valid range 0-255, default 0 = disabled
+brightness 0
+
+# Set the contrast of a video device.
+# Valid range 0-255, default 0 = disabled
+contrast 0
+
+# Set the saturation of a video device.
+# Valid range 0-255, default 0 = disabled
+saturation 0
+
+# Set the hue of a video device (NTSC feature).
+# Valid range 0-255, default 0 = disabled
+hue 0
+
+
+############################################################
+# Round Robin (multiple inputs on same video device name)
+############################################################
+
+# Number of frames to capture in each roundrobin step (default: 1)
+roundrobin_frames 1
+
+# Number of frames to skip before each roundrobin step (default: 1)
+roundrobin_skip 1
+
+# Try to filter out noise generated by roundrobin (default: off)
+switchfilter off
+
+
+############################################################
+# Motion Detection Settings:
+############################################################
+
+# Threshold for number of changed pixels in an image that
+# triggers motion detection (default: 1500)
+threshold 1500
+
+# Automatically tune the threshold down if possible (default: off)
+threshold_tune off
+
+# Noise threshold for the motion detection (default: 32)
+noise_level 32
+
+# Automatically tune the noise threshold (default: on)
+noise_tune on
+
+# Despeckle motion image using (e)rode or (d)ilate or (l)abel (Default: not defined)
+# Recommended value is EedDl. Any combination (and number of) of E, e, d, and D is valid.
+# (l)abeling must only be used once and the 'l' must be the last letter.
+# Comment out to disable
+despeckle_filter EedDl
+
+# Detect motion in predefined areas (1 - 9). Areas are numbered like that:  1 2 3
+# A script (on_area_detected) is started immediately when motion is         4 5 6
+# detected in one of the given areas, but only once during an event.        7 8 9
+# One or more areas can be specified with this option. Take care: This option
+# does NOT restrict detection to these areas! (Default: not defined)
+; area_detect value
+
+# PGM file to use as a sensitivity mask.
+# Full path name to. (Default: not defined)
+; mask_file value
+
+# Dynamically create a mask file during operation (default: 0)
+# Adjust speed of mask changes from 0 (off) to 10 (fast)
+smart_mask_speed 0
+
+# Ignore sudden massive light intensity changes given as a percentage of the picture
+# area that changed intensity. Valid range: 0 - 100 , default: 0 = disabled
+lightswitch 0
+
+# Picture frames must contain motion at least the specified number of frames
+# in a row before they are detected as true motion. At the default of 1, all
+# motion is detected. Valid range: 1 to thousands, recommended 1-5
+minimum_motion_frames 1
+
+# Specifies the number of pre-captured (buffered) pictures from before motion
+# was detected that will be output at motion detection.
+# Recommended range: 0 to 5 (default: 0)
+# Do not use large values! Large values will cause Motion to skip video frames and
+# cause unsmooth movies. To smooth movies use larger values of post_capture instead.
+pre_capture 0
+
+# Number of frames to capture after motion is no longer detected (default: 0)
+post_capture 0
+
+# Event Gap is the seconds of no motion detection that triggers the end of an event.
+# An event is defined as a series of motion images taken within a short timeframe.
+# Recommended value is 60 seconds (Default). The value -1 is allowed and disables
+# events causing all Motion to be written to one single movie file and no pre_capture.
+# If set to 0, motion is running in gapless mode. Movies don't have gaps anymore. An
+# event ends right after no more motion is detected and post_capture is over.
+event_gap 60
+
+# Maximum length in seconds of a movie
+# When value is exceeded a new movie file is created. (Default: 0 = infinite)
+max_movie_time 0
+
+# Always save images even if there was no motion (default: off)
+emulate_motion off
+
+
+############################################################
+# Image File Output
+############################################################
+
+# Output 'normal' pictures when motion is detected (default: on)
+# Valid values: on, off, first, best, center
+# When set to 'first', only the first picture of an event is saved.
+# Picture with most motion of an event is saved when set to 'best'.
+# Picture with motion nearest center of picture is saved when set to 'center'.
+# Can be used as preview shot for the corresponding movie.
+output_pictures on
+
+# Output pictures with only the pixels moving object (ghost images) (default: off)
+output_debug_pictures off
+
+# The quality (in percent) to be used by the jpeg compression (default: 75)
+quality 75
+
+# Type of output images
+# Valid values: jpeg, ppm (default: jpeg)
+picture_type jpeg
+
+############################################################
+# FFMPEG related options
+# Film (movies) file output, and deinterlacing of the video input
+# The options movie_filename and timelapse_filename are also used
+# by the ffmpeg feature
+############################################################
+
+# Use ffmpeg to encode movies in realtime (default: off)
+ffmpeg_output_movies on
+
+# Use ffmpeg to make movies with only the pixels moving
+# object (ghost images) (default: off)
+ffmpeg_output_debug_movies off
+
+# Use ffmpeg to encode a timelapse movie
+# Default value 0 = off - else save frame every Nth second
+ffmpeg_timelapse 0
+
+# The file rollover mode of the timelapse video
+# Valid values: hourly, daily (default), weekly-sunday, weekly-monday, monthly, manual
+ffmpeg_timelapse_mode daily
+
+# Bitrate to be used by the ffmpeg encoder (default: 400000)
+# This option is ignored if ffmpeg_variable_bitrate is not 0 (disabled)
+ffmpeg_bps 500000
+
+# Enables and defines variable bitrate for the ffmpeg encoder.
+# ffmpeg_bps is ignored if variable bitrate is enabled.
+# Valid values: 0 (default) = fixed bitrate defined by ffmpeg_bps,
+# or the range 2 - 31 where 2 means best quality and 31 is worst.
+ffmpeg_variable_bitrate 0
+
+# Codec to used by ffmpeg for the video compression.
+# Timelapse mpegs are always made in mpeg1 format independent from this option.
+# Supported formats are: mpeg1 (ffmpeg-0.4.8 only), mpeg4 (default), and msmpeg4.
+# mpeg1 - gives you files with extension .mpg
+# mpeg4 or msmpeg4 - gives you files with extension .avi
+# msmpeg4 is recommended for use with Windows Media Player because
+# it requires no installation of codec on the Windows client.
+# swf - gives you a flash film with extension .swf
+# flv - gives you a flash video with extension .flv
+# ffv1 - FF video codec 1 for Lossless Encoding ( experimental )
+# mov - QuickTime ( testing )
+# ogg - Ogg/Theora ( testing )
+ffmpeg_video_codec mpeg4
+
+# Use ffmpeg to deinterlace video. Necessary if you use an analog camera
+# and see horizontal combing on moving objects in video or pictures.
+# (default: off)
+ffmpeg_deinterlace off
+
+############################################################
+# SDL Window
+############################################################
+
+# Number of motion thread to show in SDL Window (default: 0 = disabled)
+sdl_threadnr 0
+
+############################################################
+# External pipe to video encoder
+# Replacement for FFMPEG builtin encoder for ffmpeg_output_movies only.
+# The options movie_filename and timelapse_filename are also used
+# by the ffmpeg feature
+#############################################################
+
+# Bool to enable or disable extpipe (default: off)
+use_extpipe off
+
+# External program (full path and opts) to pipe raw video to
+# Generally, use '-' for STDIN...
+;extpipe mencoder -demuxer rawvideo -rawvideo w=320:h=240:i420 -ovc x264 -x264encopts bframes=4:frameref=1:subq=1:scenecut=-1:nob_adapt:threads=1:keyint=1000:8x8dct:vbv_bufsize=4000:crf=24:partitions=i8x8,i4x4:vbv_maxrate=800:no-chroma-me -vf denoise3d=16:12:48:4,pp=lb -of   avi -o %f.avi - -fps %fps
+
+
+
+############################################################
+# Snapshots (Traditional Periodic Webcam File Output)
+############################################################
+
+# Make automated snapshot every N seconds (default: 0 = disabled)
+snapshot_interval 0
+
+
+############################################################
+# Text Display
+# %Y = year, %m = month, %d = date,
+# %H = hour, %M = minute, %S = second, %T = HH:MM:SS,
+# %v = event, %q = frame number, %t = thread (camera) number,
+# %D = changed pixels, %N = noise level, \n = new line,
+# %i and %J = width and height of motion area,
+# %K and %L = X and Y coordinates of motion center
+# %C = value defined by text_event - do not use with text_event!
+# You can put quotation marks around the text to allow
+# leading spaces
+############################################################
+
+# Locate and draw a box around the moving object.
+# Valid values: on, off, preview (default: off)
+# Set to 'preview' will only draw a box in preview_shot pictures.
+locate_motion_mode off
+
+# Set the look and style of the locate box if enabled.
+# Valid values: box, redbox, cross, redcross (default: box)
+# Set to 'box' will draw the traditional box.
+# Set to 'redbox' will draw a red box.
+# Set to 'cross' will draw a little cross to mark center.
+# Set to 'redcross' will draw a little red cross to mark center.
+locate_motion_style box
+
+# Draws the timestamp using same options as C function strftime(3)
+# Default: %Y-%m-%d\n%T = date in ISO format and time in 24 hour clock
+# Text is placed in lower right corner
+text_right %Y-%m-%d\n%T-%q
+
+# Draw a user defined text on the images using same options as C function strftime(3)
+# Default: Not defined = no text
+# Text is placed in lower left corner
+; text_left CAMERA %t
+
+# Draw the number of changed pixed on the images (default: off)
+# Will normally be set to off except when you setup and adjust the motion settings
+# Text is placed in upper right corner
+text_changes off
+
+# This option defines the value of the special event conversion specifier %C
+# You can use any conversion specifier in this option except %C. Date and time
+# values are from the timestamp of the first image in the current event.
+# Default: %Y%m%d%H%M%S
+# The idea is that %C can be used filenames and text_left/right for creating
+# a unique identifier for each event.
+text_event %Y%m%d%H%M%S
+
+# Draw characters at twice normal size on images. (default: off)
+text_double off
+
+
+# Text to include in a JPEG EXIF comment
+# May be any text, including conversion specifiers.
+# The EXIF timestamp is included independent of this text.
+;exif_text %i%J/%K%L
+
+############################################################
+# Target Directories and filenames For Images And Films
+# For the options snapshot_, picture_, movie_ and timelapse_filename
+# you can use conversion specifiers
+# %Y = year, %m = month, %d = date,
+# %H = hour, %M = minute, %S = second,
+# %v = event, %q = frame number, %t = thread (camera) number,
+# %D = changed pixels, %N = noise level,
+# %i and %J = width and height of motion area,
+# %K and %L = X and Y coordinates of motion center
+# %C = value defined by text_event
+# Quotation marks round string are allowed.
+############################################################
+
+# Target base directory for pictures and films
+# Recommended to use absolute path. (Default: current working directory)
+target_dir /usr/local/apache2/htdocs/cam1
+
+# File path for snapshots (jpeg or ppm) relative to target_dir
+# Default: %v-%Y%m%d%H%M%S-snapshot
+# Default value is equivalent to legacy oldlayout option
+# For Motion 3.0 compatible mode choose: %Y/%m/%d/%H/%M/%S-snapshot
+# File extension .jpg or .ppm is automatically added so do not include this.
+# Note: A symbolic link called lastsnap.jpg created in the target_dir will always
+# point to the latest snapshot, unless snapshot_filename is exactly 'lastsnap'
+snapshot_filename %v-%Y%m%d%H%M%S-snapshot
+
+# File path for motion triggered images (jpeg or ppm) relative to target_dir
+# Default: %v-%Y%m%d%H%M%S-%q
+# Default value is equivalent to legacy oldlayout option
+# For Motion 3.0 compatible mode choose: %Y/%m/%d/%H/%M/%S-%q
+# File extension .jpg or .ppm is automatically added so do not include this
+# Set to 'preview' together with best-preview feature enables special naming
+# convention for preview shots. See motion guide for details
+picture_filename %v-%Y%m%d%H%M%S-%q
+
+# File path for motion triggered ffmpeg films (movies) relative to target_dir
+# Default: %v-%Y%m%d%H%M%S
+# Default value is equivalent to legacy oldlayout option
+# For Motion 3.0 compatible mode choose: %Y/%m/%d/%H%M%S
+# File extension .mpg or .avi is automatically added so do not include this
+# This option was previously called ffmpeg_filename
+movie_filename %v-%Y%m%d%H%M%S
+
+# File path for timelapse movies relative to target_dir
+# Default: %Y%m%d-timelapse
+# Default value is near equivalent to legacy oldlayout option
+# For Motion 3.0 compatible mode choose: %Y/%m/%d-timelapse
+# File extension .mpg is automatically added so do not include this
+timelapse_filename %Y%m%d-timelapse
+
+############################################################
+# Global Network Options
+############################################################
+# Enable or disable IPV6 for http control and stream (default: off )
+ipv6_enabled off
+
+############################################################
+# Live Stream Server
+############################################################
+
+# The mini-http server listens to this port for requests (default: 0 = disabled)
+stream_port 8081
+
+# Quality of the jpeg (in percent) images produced (default: 50)
+stream_quality 50
+
+# Output frames at 1 fps when no motion is detected and increase to the
+# rate given by stream_maxrate when motion is detected (default: off)
+stream_motion off
+
+# Maximum framerate for stream streams (default: 1)
+stream_maxrate 1
+
+# Restrict stream connections to localhost only (default: on)
+stream_localhost on
+
+# Limits the number of images per connection (default: 0 = unlimited)
+# Number can be defined by multiplying actual stream rate by desired number of seconds
+# Actual stream rate is the smallest of the numbers framerate and stream_maxrate
+stream_limit 0
+
+# Set the authentication method (default: 0)
+# 0 = disabled
+# 1 = Basic authentication
+# 2 = MD5 digest (the safer authentication)
+stream_auth_method 0
+
+# Authentication for the stream. Syntax username:password
+# Default: not defined (Disabled)
+; stream_authentication username:password
+
+
+############################################################
+# HTTP Based Control
+############################################################
+
+# TCP/IP port for the http server to listen on (default: 0 = disabled)
+webcontrol_port 8080
+
+# Restrict control connections to localhost only (default: on)
+webcontrol_localhost on
+
+# Output for http server, select off to choose raw text plain (default: on)
+webcontrol_html_output on
+
+# Authentication for the http based control. Syntax username:password
+# Default: not defined (Disabled)
+; webcontrol_authentication username:password
+
+
+############################################################
+# Tracking (Pan/Tilt)
+#############################################################
+
+# Type of tracker (0=none (default), 1=stepper, 2=iomojo, 3=pwc, 4=generic, 5=uvcvideo, 6=servo)
+# The generic type enables the definition of motion center and motion size to
+# be used with the conversion specifiers for options like on_motion_detected
+track_type 0
+
+# Enable auto tracking (default: off)
+track_auto off
+
+# Serial port of motor (default: none)
+;track_port /dev/ttyS0
+
+# Motor number for x-axis (default: 0)
+;track_motorx 0
+
+# Set motorx reverse (default: 0)
+;track_motorx_reverse 0
+
+# Motor number for y-axis (default: 0)
+;track_motory 1
+
+# Set motory reverse (default: 0)
+;track_motory_reverse 0
+
+# Maximum value on x-axis (default: 0)
+;track_maxx 200
+
+# Minimum value on x-axis (default: 0)
+;track_minx 50
+
+# Maximum value on y-axis (default: 0)
+;track_maxy 200
+
+# Minimum value on y-axis (default: 0)
+;track_miny 50
+
+# Center value on x-axis (default: 0)
+;track_homex 128
+
+# Center value on y-axis (default: 0)
+;track_homey 128
+
+# ID of an iomojo camera if used (default: 0)
+track_iomojo_id 0
+
+# Angle in degrees the camera moves per step on the X-axis
+# with auto-track (default: 10)
+# Currently only used with pwc type cameras
+track_step_angle_x 10
+
+# Angle in degrees the camera moves per step on the Y-axis
+# with auto-track (default: 10)
+# Currently only used with pwc type cameras
+track_step_angle_y 10
+
+# Delay to wait for after tracking movement as number
+# of picture frames (default: 10)
+track_move_wait 10
+
+# Speed to set the motor to (stepper motor option) (default: 255)
+track_speed 255
+
+# Number of steps to make (stepper motor option) (default: 40)
+track_stepsize 40
+
+
+############################################################
+# External Commands, Warnings and Logging:
+# You can use conversion specifiers for the on_xxxx commands
+# %Y = year, %m = month, %d = date,
+# %H = hour, %M = minute, %S = second,
+# %v = event, %q = frame number, %t = thread (camera) number,
+# %D = changed pixels, %N = noise level,
+# %i and %J = width and height of motion area,
+# %K and %L = X and Y coordinates of motion center
+# %C = value defined by text_event
+# %f = filename with full path
+# %n = number indicating filetype
+# Both %f and %n are only defined for on_picture_save,
+# on_movie_start and on_movie_end
+# Quotation marks round string are allowed.
+############################################################
+
+# Do not sound beeps when detecting motion (default: on)
+# Note: Motion never beeps when running in daemon mode.
+quiet on
+
+# Command to be executed when an event starts. (default: none)
+# An event starts at first motion detected after a period of no motion defined by event_gap
+; on_event_start value
+
+# Command to be executed when an event ends after a period of no motion
+# (default: none). The period of no motion is defined by option event_gap.
+; on_event_end value
+
+# Command to be executed when a picture (.ppm|.jpg) is saved (default: none)
+# To give the filename as an argument to a command append it with %f
+; on_picture_save value
+
+# Command to be executed when a motion frame is detected (default: none)
+; on_motion_detected value
+
+# Command to be executed when motion in a predefined area is detected
+# Check option 'area_detect'.   (default: none)
+; on_area_detected value
+
+# Command to be executed when a movie file (.mpg|.avi) is created. (default: none)
+# To give the filename as an argument to a command append it with %f
+; on_movie_start value
+
+# Command to be executed when a movie file (.mpg|.avi) is closed. (default: none)
+# To give the filename as an argument to a command append it with %f
+; on_movie_end value
+
+# Command to be executed when a camera can't be opened or if it is lost
+# NOTE: There is situations when motion don't detect a lost camera!
+# It depends on the driver, some drivers dosn't detect a lost camera at all
+# Some hangs the motion thread. Some even hangs the PC! (default: none)
+; on_camera_lost value
+
+#####################################################################
+# Common Options for database features.
+# Options require database options to be active also.
+#####################################################################
+
+# Log to the database when creating motion triggered picture file  (default: on)
+; sql_log_picture on
+
+# Log to the database when creating a snapshot image file (default: on)
+; sql_log_snapshot on
+
+# Log to the database when creating motion triggered movie file (default: off)
+; sql_log_movie off
+
+# Log to the database when creating timelapse movies file (default: off)
+; sql_log_timelapse off
+
+# SQL query string that is sent to the database
+# Use same conversion specifiers has for text features
+# Additional special conversion specifiers are
+# %n = the number representing the file_type
+# %f = filename with full path
+# Default value:
+# Create tables :
+## 
+# Mysql
+# CREATE TABLE security (camera int, filename char(80) not null, frame int, file_type int, time_stamp timestamp(14), event_time_stamp timestamp(14));
+#
+# Postgresql
+# CREATE TABLE security (camera int, filename char(80) not null, frame int, file_type int, time_stamp timestamp without time zone, event_time_stamp timestamp without time zone);
+#
+# insert into security(camera, filename, frame, file_type, time_stamp, text_event) values('%t', '%f', '%q', '%n', '%Y-%m-%d %T', '%C')
+; sql_query insert into security(camera, filename, frame, file_type, time_stamp, event_time_stamp) values('%t', '%f', '%q', '%n', '%Y-%m-%d %T', '%C')
+
+
+############################################################
+# Database Options
+############################################################
+
+# database type : mysql, postgresql, sqlite3 (default : not defined)
+; database_type value
+
+# database to log to (default: not defined)
+; database_dbname value
+
+# The host on which the database is located (default: localhost)
+; database_host value
+
+# User account name for database (default: not defined)
+; database_user value
+
+# User password for database (default: not defined)
+; database_password value
+
+# Port on which the database is located
+#  mysql 3306 , postgresql 5432 (default: not defined)
+; database_port value
+
+############################################################
+# Database Options For SQLite3
+############################################################
+
+# SQLite3 database (file path) (default: not defined)
+; sqlite3_db value
+
+
+
+############################################################
+# Video Loopback Device (vloopback project)
+############################################################
+
+# Output images to a video4linux loopback device
+# The value '-' means next available (default: not defined)
+; video_pipe value
+
+# Output motion images to a video4linux loopback device
+# The value '-' means next available (default: not defined)
+; motion_video_pipe value
+
+
+##############################################################
+# Thread config files - One for each camera.
+# Except if only one camera - You only need this config file.
+# If you have more than one camera you MUST define one thread
+# config file for each camera in addition to this config file.
+##############################################################
+
+# Remember: If you have more than one camera you must have one
+# thread file for each camera. E.g. 2 cameras requires 3 files:
+# This motion.conf file AND thread1.conf and thread2.conf.
+# Only put the options that are unique to each camera in the
+# thread config files.
+; thread /usr/local/etc/thread1.conf
+; thread /usr/local/etc/thread2.conf
+; thread /usr/local/etc/thread3.conf
+; thread /usr/local/etc/thread4.conf
+
diff --git a/netcam_ftp.c b/netcam_ftp.c
index 0a129b2..7a0451f 100644
--- a/netcam_ftp.c
+++ b/netcam_ftp.c
@@ -790,10 +790,10 @@ int ftp_get_socket(ftp_context_pointer ctxt)
 */
 int ftp_send_type(ftp_context_pointer ctxt, char type)
 {
-    char buf[100], utype;
+    char buf[100];
     int len, res;
 
-    utype = toupper(type);
+    toupper(type);
     /* Assure transfer will be in "image" mode. */
     snprintf(buf, sizeof(buf), "TYPE I\r\n");
     len = strlen(buf);
diff --git a/picture.c b/picture.c
index 196f220..9284280 100644
--- a/picture.c
+++ b/picture.c
@@ -177,7 +177,7 @@ static void put_direntry(struct tiff_writing *into, const char *data, unsigned l
     } else {
 	    /* Longer entries are stored out-of-line */
 	    unsigned offset = into->data_offset;
-	
+
         while ((offset & 0x03) != 0) {  /* Alignment */
 	        into->base[offset] = 0;
 	        offset ++;
@@ -324,7 +324,7 @@ static void put_jpeg_exif(j_compress_ptr cinfo,
 
     JOCTET *marker = malloc(buffer_size);
     memcpy(marker, exif_marker_start, 14); /* EXIF and TIFF headers */
-    
+
     struct tiff_writing writing = (struct tiff_writing) {
 	.base = marker + 6, /* base address for intra-TIFF offsets */
 	.buf = marker + 14, /* current write position */
@@ -338,10 +338,10 @@ static void put_jpeg_exif(j_compress_ptr cinfo,
 
     if (description)
 	    put_stringentry(&writing, TIFF_TAG_IMAGE_DESCRIPTION, description, 0);
-    
+
     if (datetime)
 	    put_stringentry(&writing, TIFF_TAG_DATETIME, datetime, 1);
-    
+
     if (ifd1_tagcount > 0) {
 	    /* Offset of IFD1 - TIFF header + IFD0 size. */
 	    unsigned ifd1_offset = 8 + 6 + ( 12 * ifd0_tagcount );
@@ -369,10 +369,10 @@ static void put_jpeg_exif(j_compress_ptr cinfo,
 
 	    if (datetime)
 	        put_stringentry(&writing, EXIF_TAG_ORIGINAL_DATETIME, datetime, 1);
-	    
+
         if (box)
 	        put_subjectarea(&writing, box);
-	    
+
         if (subtime)
 	        put_stringentry(&writing, EXIF_TAG_ORIGINAL_DATETIME_SS, subtime, 0);
 
@@ -394,7 +394,7 @@ static void put_jpeg_exif(j_compress_ptr cinfo,
 
     if (description)
 	    free(description);
-    
+
     free(marker);
 }
 
@@ -679,7 +679,6 @@ static void put_ppm_bgr24_file(FILE *picture, unsigned char *image, int width, i
     unsigned char *u = image + width * height;
     unsigned char *v = u + (width * height) / 4;
     int r, g, b;
-    int warningkiller;
     unsigned char rgb[3];
 
     /*
@@ -722,7 +721,7 @@ static void put_ppm_bgr24_file(FILE *picture, unsigned char *image, int width, i
                 v++;
             }
             /* ppm is rgb not bgr */
-            warningkiller = fwrite(rgb, 1, 3, picture);
+            fwrite(rgb, 1, 3, picture);
         }
         if (y & 1) {
             u -= width / 2;
diff --git a/stream.c b/stream.c
index 624b92b..a073617 100644
--- a/stream.c
+++ b/stream.c
@@ -242,7 +242,8 @@ static void* handle_basic_auth(void* param)
     pthread_exit(NULL);
 
 Error:
-    write(p->sock, request_auth_response_template, strlen (request_auth_response_template));
+    if (write(p->sock, request_auth_response_template, strlen (request_auth_response_template)) < 0)
+        MOTION_LOG(DBG, TYPE_STREAM, SHOW_ERRNO, "%s: write failure 1:handle_basic_auth");
 
 Invalid_Request:
     close(p->sock);
@@ -569,8 +570,10 @@ Error:
                 "Content-Length: %Zu\r\n\r\n",
                 request_auth_response_template, server_nonce,
                 KEEP_ALIVE_TIMEOUT, strlen(auth_failed_html_template));
-        write(p->sock, buffer, strlen(buffer));
-        write(p->sock, auth_failed_html_template, strlen(auth_failed_html_template));
+        if (write(p->sock, buffer, strlen(buffer)) < 0)
+            MOTION_LOG(DBG, TYPE_STREAM, SHOW_ERRNO, "%s: write failure 1:handle_md5_digest");
+        if (write(p->sock, auth_failed_html_template, strlen(auth_failed_html_template)) < 0)
+            MOTION_LOG(DBG, TYPE_STREAM, SHOW_ERRNO, "%s: write failure 2:handle_md5_digest");
     }
 
     // OK - Access
@@ -607,7 +610,8 @@ InternalError:
     if(server_pass)
         free(server_pass);
 
-    write(p->sock, internal_error_template, strlen(internal_error_template));
+    if (write(p->sock, internal_error_template, strlen(internal_error_template)) < 0)
+      MOTION_LOG(DBG, TYPE_STREAM, SHOW_ERRNO, "%s: write failure 3:handle_md5_digest");
 
 Invalid_Request:
     close(p->sock);
diff --git a/thread1.conf b/thread1.conf
new file mode 100644
index 0000000..fd702b1
--- /dev/null
+++ b/thread1.conf
@@ -0,0 +1,57 @@
+# /usr/local/etc/thread1.conf
+#
+# This config file was generated by motion trunkREVUNKNOWN 
+
+
+
+###########################################################
+# Capture device options
+############################################################
+
+# Videodevice to be used for capturing  (default /dev/video0)
+# for FreeBSD default is /dev/bktr0 
+videodevice /dev/video0
+
+# The video input to be used (default: -1)
+# Should normally be set to 1 for video/TV cards, and -1 for USB cameras 
+input -1
+
+# Draw a user defined text on the images using same options as C function strftime(3)
+# Default: Not defined = no text
+# Text is placed in lower left corner
+text_left CAMERA 1
+
+
+############################################################
+# Target Directories and filenames For Images And Films
+# For the options snapshot_, picture_, mpeg_ and timelapse_filename
+# you can use conversion specifiers
+# %Y = year, %m = month, %d = date,
+# %H = hour, %M = minute, %S = second,
+# %v = event, %q = frame number, %t = thread (camera) number,
+# %D = changed pixels, %N = noise level,
+# %i and %J = width and height of motion area,
+# %K and %L = X and Y coordinates of motion center
+# %C = value defined by text_event
+# Quotation marks round string are allowed.
+############################################################
+
+# Target base directory for pictures and films
+# Recommended to use absolute patch. (Default: current working directory)
+target_dir /usr/local/apache2/htdocs/cam1
+
+
+############################################################
+# Live Stream Server
+############################################################
+
+# The mini-http server listens to this port for requests (default: 0 = disabled)
+stream_port 8081
+
+# Command to be executed when a picture (.ppm|.jpg) is saved (default: none)
+# The filename of the picture is appended as an argument for the command.
+on_picture_save /usr/local/motion-extras/camparse1.pl
+
+# Command to be executed when a movie file (.mpg|.avi) is closed. (default: none)
+# Filename of movie is appended as an argument for the command.
+on_movie_end /usr/local/motion-extras/mpegparse1.pl 
diff --git a/thread2.conf b/thread2.conf
new file mode 100644
index 0000000..30f3423
--- /dev/null
+++ b/thread2.conf
@@ -0,0 +1,58 @@
+# /usr/local/etc/thread2.conf
+#
+# This config file was generated by motion trunkREVUNKNOWN
+
+
+
+###########################################################
+# Capture device options
+############################################################
+
+# Videodevice to be used for capturing  (default /dev/video0)
+# for FreeBSD default is /dev/bktr0 
+videodevice /dev/video1
+
+# The video input to be used (default: -1)
+# Should normally be set to 1 for video/TV cards, and -1 for USB cameras 
+input 1
+
+# Draw a user defined text on the images using same options as C function strftime(3)
+# Default: Not defined = no text
+# Text is placed in lower left corner
+text_left CAMERA 2
+
+
+############################################################
+# Target Directories and filenames For Images And Films
+# For the options snapshot_, picture_, mpeg_ and timelapse_filename
+# you can use conversion specifiers
+# %Y = year, %m = month, %d = date,
+# %H = hour, %M = minute, %S = second,
+# %v = event, %q = frame number, %t = thread (camera) number,
+# %D = changed pixels, %N = noise level,
+# %i and %J = width and height of motion area,
+# %K and %L = X and Y coordinates of motion center
+# %C = value defined by text_event
+# Quotation marks round string are allowed.
+############################################################
+
+# Target base directory for pictures and films
+# Recommended to use absolute patch. (Default: current working directory)
+target_dir /usr/local/apache2/htdocs/cam2
+
+
+############################################################
+# Live Stream Server
+############################################################
+
+# The mini-http server listens to this port for requests (default: 0 = disabled)
+stream_port 8082
+
+# Command to be executed when a picture (.ppm|.jpg) is saved (default: none)
+# The filename of the picture is appended as an argument for the command.
+on_picture_save /usr/local/motion-extras/camparse2.pl
+
+# Command to be executed when a movie file (.mpg|.avi) is closed. (default: none)
+# Filename of movie is appended as an argument for the command.
+on_movie_end /usr/local/motion-extras/mpegparse2.pl 
+
diff --git a/thread3.conf b/thread3.conf
new file mode 100644
index 0000000..f66adaa
--- /dev/null
+++ b/thread3.conf
@@ -0,0 +1,60 @@
+# /usr/local/etc/thread3.conf
+#
+# This config file was generated by motion trunkREVUNKNOWN 
+
+
+
+###########################################################
+# Capture device options
+############################################################
+
+# Videodevice to be used for capturing  (default /dev/video0)
+# for FreeBSD default is /dev/bktr0 
+videodevice /dev/video2
+
+# The video input to be used (default: -1)
+# Should normally be set to 1 for video/TV cards, and -1 for USB cameras 
+input -1
+
+# Draw a user defined text on the images using same options as C function strftime(3)
+# Default: Not defined = no text
+# Text is placed in lower left corner
+text_left CAMERA 3
+
+
+############################################################
+# Target Directories and filenames For Images And Films
+# For the options snapshot_, picture_, mpeg_ and timelapse_filename
+# you can use conversion specifiers
+# %Y = year, %m = month, %d = date,
+# %H = hour, %M = minute, %S = second,
+# %v = event, %q = frame number, %t = thread (camera) number,
+# %D = changed pixels, %N = noise level,
+# %i and %J = width and height of motion area,
+# %K and %L = X and Y coordinates of motion center
+# %C = value defined by text_event
+# Quotation marks round string are allowed.
+############################################################
+
+# Target base directory for pictures and films
+# Recommended to use absolute patch. (Default: current working directory)
+target_dir /usr/local/apache2/htdocs/cam3
+
+
+############################################################
+# Live Stream Server
+############################################################
+
+# The mini-http server listens to this port for requests (default: 0 = disabled)
+stream_port 8083
+
+# Command to be executed when a picture (.ppm|.jpg) is saved (default: none)
+# The filename of the picture is appended as an argument for the command.
+on_picture_save /usr/local/motion-extras/camparse3.pl
+
+# Command to be executed when a movie file (.mpg|.avi) is closed. (default: none)
+# Filename of movie is appended as an argument for the command.
+on_movie_end /usr/local/motion-extras/mpegparse3.pl 
+
+
+
diff --git a/thread4.conf b/thread4.conf
new file mode 100644
index 0000000..2462161
--- /dev/null
+++ b/thread4.conf
@@ -0,0 +1,62 @@
+# /usr/local/etc/thread4.conf
+#
+# This config file was generated by motion trunkREVUNKNOWN 
+
+###########################################################
+# Capture device options
+############################################################
+
+# URL to use if you are using a network camera, size will be autodetected (incl http:// ftp:// or file:///)
+# Must be a URL that returns single jpeg pictures or a raw mjpeg stream. Default: Not defined
+netcam_url http://192.168.1.6:8093/
+
+# The setting for keep-alive of network socket, should improve performance on compatible net cameras.
+# off:   The historical implementation using HTTP/1.0, closing the socket after each http request.
+# force: Use HTTP/1.0 requests with keep alive header to reuse the same connection.
+# on:    Use HTTP/1.1 requests that support keep alive as default.
+# Default: off
+netcam_keepalive force
+
+# Set less strict jpeg checks for network cameras with a poor/buggy firmware.
+# Default: off
+netcam_tolerant_check on
+
+# Draw a user defined text on the images using same options as C function strftime(3)
+# Default: Not defined = no text
+# Text is placed in lower left corner
+text_left CAMERA 4
+
+############################################################
+# Target Directories and filenames For Images And Films
+# For the options snapshot_, picture_, mpeg_ and timelapse_filename
+# you can use conversion specifiers
+# %Y = year, %m = month, %d = date,
+# %H = hour, %M = minute, %S = second,
+# %v = event, %q = frame number, %t = thread (camera) number,
+# %D = changed pixels, %N = noise level,
+# %i and %J = width and height of motion area,
+# %K and %L = X and Y coordinates of motion center
+# %C = value defined by text_event
+# Quotation marks round string are allowed.
+############################################################
+
+# Target base directory for pictures and films
+# Recommended to use absolute patch. (Default: current working directory)
+target_dir /usr/local/apache2/htdocs/cam4
+
+
+############################################################
+# Live Stream Server
+############################################################
+
+# The mini-http server listens to this port for requests (default: 0 = disabled)
+stream_port 8084
+
+# Command to be executed when a picture (.ppm|.jpg) is saved (default: none)
+# The filename of the picture is appended as an argument for the command.
+on_picture_save /usr/local/motion-extras/camparse4.pl
+
+# Command to be executed when a movie file (.mpg|.avi) is closed. (default: none)
+# Filename of movie is appended as an argument for the command.
+on_movie_end /usr/local/motion-extras/mpegparse4.pl 
+
diff --git a/track.c b/track.c
index 91e89d7..0d7e3b3 100644
--- a/track.c
+++ b/track.c
@@ -563,7 +563,6 @@ static unsigned int servo_status(struct context *cnt, unsigned int motor)
 
 static unsigned int servo_center(struct context *cnt, int x_offset, int y_offset)
 {
-    unsigned int ret = 0;
     int x_offset_abs;
     int y_offset_abs;
 
@@ -591,7 +590,7 @@ static unsigned int servo_center(struct context *cnt, int x_offset, int y_offset
     if (x_offset_abs <= cnt->track.maxx  && x_offset_abs >= cnt->track.minx) {
         /* Set Speed , TODO : it should be done only when speed changes */
         servo_command(cnt, cnt->track.motorx, SERVO_COMMAND_SPEED, cnt->track.speed);
-        ret = servo_command(cnt, cnt->track.motorx, SERVO_COMMAND_ABSOLUTE, x_offset_abs);
+        servo_command(cnt, cnt->track.motorx, SERVO_COMMAND_ABSOLUTE, x_offset_abs);
     }
 
     /* y-axis */
@@ -603,7 +602,7 @@ static unsigned int servo_center(struct context *cnt, int x_offset, int y_offset
     if (y_offset_abs <= cnt->track.maxy && y_offset_abs >= cnt->track.minx) {
         /* Set Speed , TODO : it should be done only when speed changes */
         servo_command(cnt, cnt->track.motory, SERVO_COMMAND_SPEED, cnt->track.speed);
-        ret = servo_command(cnt, cnt->track.motory, SERVO_COMMAND_ABSOLUTE, y_offset_abs);
+        servo_command(cnt, cnt->track.motory, SERVO_COMMAND_ABSOLUTE, y_offset_abs);
     }
 
     return cnt->track.move_wait;
diff --git a/webhttpd.c b/webhttpd.c
index 22b5add..f7449df 100644
--- a/webhttpd.c
+++ b/webhttpd.c
@@ -281,6 +281,8 @@ static void send_template_raw(int client_socket, char *res)
 {
     ssize_t nwrite = 0;
     nwrite = write_nonblock(client_socket, res, strlen(res));
+    if (nwrite < 0)
+        MOTION_LOG(DBG, TYPE_STREAM, SHOW_ERRNO, "%s: write_nonblock returned value less than zero.");
 }
 
 /**
@@ -290,6 +292,9 @@ static void send_template_end_client(int client_socket)
 {
     ssize_t nwrite = 0;
     nwrite = write_nonblock(client_socket, end_template, strlen(end_template));
+    if (nwrite < 0)
+        MOTION_LOG(DBG, TYPE_STREAM, SHOW_ERRNO, "%s: write_nonblock returned value less than zero.");
+
 }
 
 /**
@@ -303,6 +308,9 @@ static void response_client(int client_socket, const char *template, char *back)
         send_template(client_socket, back);
         send_template_end_client(client_socket);
     }
+    if (nwrite < 0)
+        MOTION_LOG(DBG, TYPE_STREAM, SHOW_ERRNO, "%s: write_nonblock returned value less than zero.");
+
 }
 
 /**
-- 
1.8.1.4

